reg_2017 <- read_csv("data/regular_season/reg_pbp_2017.csv")
reg_2018 <- read_csv("data/regular_season/reg_pbp_2018.csv")
reg_2019 <- read_csv("data/regular_season/reg_pbp_2019.csv")
reg_2009$Season = 2009
reg_2010$Season = 2010
reg_2011$Season = 2011
reg_2012$Season = 2012
reg_2013$Season = 2013
reg_2014$Season = 2014
reg_2015$Season = 2015
reg_2016$Season = 2016
reg_2017$Season = 2017
reg_2018$Season = 2018
reg_2019$Season = 2019
reg_seasons = rbind(reg_2009,
reg_2010,
reg_2011,
reg_2012,
reg_2013,
reg_2014,
reg_2015,
reg_2016,
reg_2017,
reg_2018,
reg_2019)
reg_seasons = reg_seasons %>%
select(Season, down, quarter_seconds_remaining, qtr, play_type, yardline_100,
epa, first_down_rush, first_down_pass, ydstogo, pass_length, pass_location, run_gap, run_location)
reg_2009 <- read_csv("data/regular_season/reg_pbp_2009.csv")
reg_2010 <- read_csv("data/regular_season/reg_pbp_2010.csv")
reg_2011 <- read_csv("data/regular_season/reg_pbp_2011.csv")
reg_2012 <- read_csv("data/regular_season/reg_pbp_2012.csv")
reg_2013 <- read_csv("data/regular_season/reg_pbp_2013.csv")
reg_2014 <- read_csv("data/regular_season/reg_pbp_2014.csv")
reg_2015 <- read_csv("data/regular_season/reg_pbp_2015.csv")
reg_2016 <- read_csv("data/regular_season/reg_pbp_2016.csv")
reg_2017 <- read_csv("data/regular_season/reg_pbp_2017.csv")
reg_2018 <- read_csv("data/regular_season/reg_pbp_2018.csv")
reg_2019 <- read_csv("data/regular_season/reg_pbp_2019.csv")
reg_2009$Season = 2009
reg_2010$Season = 2010
reg_2011$Season = 2011
reg_2012$Season = 2012
reg_2013$Season = 2013
reg_2014$Season = 2014
reg_2015$Season = 2015
reg_2016$Season = 2016
reg_2017$Season = 2017
reg_2018$Season = 2018
reg_2019$Season = 2019
reg_seasons = rbind(reg_2009,
reg_2010,
reg_2011,
reg_2012,
reg_2013,
reg_2014,
reg_2015,
reg_2016,
reg_2017,
reg_2018,
reg_2019)
# Need season, down, quarter_seconds_remaining, quarter, play_type, yardline_100
# epa, first_down_rush, first_down_pass
# quarter, down, yards left, time left in quarter, play type, pass length, pass location, run gap, run location
reg_seasons = reg_seasons %>%
select(Season, down, quarter_seconds_remaining, qtr, play_type, yardline_100,
epa, first_down_rush, first_down_pass, ydstogo, pass_length, pass_location, run_gap, run_location)
saveRDS(reg_seasons, "reg_seasons.rds")
# Make one preseason season rds file for analysis
pre_2009 <- read_csv("data/pre_season/pre_pbp_2009.csv")
pre_2010 <- read_csv("data/pre_season/pre_pbp_2010.csv")
pre_2011 <- read_csv("data/pre_season/pre_pbp_2011.csv")
pre_2012 <- read_csv("data/pre_season/pre_pbp_2012.csv")
pre_2013 <- read_csv("data/pre_season/pre_pbp_2013.csv")
pre_2014 <- read_csv("data/pre_season/pre_pbp_2014.csv")
pre_2015 <- read_csv("data/pre_season/pre_pbp_2015.csv")
pre_2016 <- read_csv("data/pre_season/pre_pbp_2016.csv")
pre_2017 <- read_csv("data/pre_season/pre_pbp_2017.csv")
pre_2018 <- read_csv("data/pre_season/pre_pbp_2018.csv")
pre_2019 <- read_csv("data/pre_season/pre_pbp_2019.csv")
pre_2009$Season = 2009
pre_2010$Season = 2010
pre_2011$Season = 2011
pre_2012$Season = 2012
pre_2013$Season = 2013
pre_2014$Season = 2014
pre_2015$Season = 2015
pre_2016$Season = 2016
pre_2017$Season = 2017
pre_2018$Season = 2018
pre_2019$Season = 2019
pre_seasons = rbind(pre_2009,
pre_2010,
pre_2011,
pre_2012,
pre_2013,
pre_2014,
pre_2015,
pre_2016,
pre_2017,
pre_2018,
pre_2019)
pre_seasons = pre_seasons %>%
select(Season, down, quarter_seconds_remaining, qtr, play_type, yardline_100,
epa, first_down_rush, first_down_pass, ydstogo, pass_length, pass_location, run_gap, run_location)
saveRDS(pre_seasons, "pre_seasons.rds")
# Make one postseason season rds file for analysis
post_2009 <- read_csv("data/post_season/post_pbp_2009.csv")
post_2010 <- read_csv("data/post_season/post_pbp_2010.csv")
post_2011 <- read_csv("data/post_season/post_pbp_2011.csv")
post_2012 <- read_csv("data/post_season/post_pbp_2012.csv")
post_2013 <- read_csv("data/post_season/post_pbp_2013.csv")
post_2014 <- read_csv("data/post_season/post_pbp_2014.csv")
post_2015 <- read_csv("data/post_season/post_pbp_2015.csv")
post_2016 <- read_csv("data/post_season/post_pbp_2016.csv")
post_2017 <- read_csv("data/post_season/post_pbp_2017.csv")
post_2018 <- read_csv("data/post_season/post_pbp_2018.csv")
post_2019 <- read_csv("data/post_season/post_pbp_2019.csv")
post_2019 = post_2019[, !(colnames(post_2019) %in% c("X1"))]
post_2009$Season = 2009
post_2010$Season = 2010
post_2011$Season = 2011
post_2012$Season = 2012
post_2013$Season = 2013
post_2014$Season = 2014
post_2015$Season = 2015
post_2016$Season = 2016
post_2017$Season = 2017
post_2018$Season = 2018
post_2019$Season = 2019
post_seasons = rbind(post_2009,
post_2010,
post_2011,
post_2012,
post_2013,
post_2014,
post_2015,
post_2016,
post_2017,
post_2018,
post_2019)
post_seasons = post_seasons %>%
select(Season, down, quarter_seconds_remaining, qtr, play_type, yardline_100,
epa, first_down_rush, first_down_pass, ydstogo, pass_length, pass_location, run_gap, run_location)
saveRDS(post_seasons, "post_seasons.rds")
pre = readRDS("pre_seasons.rds")
reg = readRDS("reg_seasons.rds")
post = readRDS("post_seasons.rds")
sent = readRDS("2019_sentiments.rds")
View(reg)
logreg = glm(success ~ qtr + down + ydstogo + quarter_seconds_remaining + play_type + pass_length + pass_location, data=reg, family=binomial(link="logit"))
View(reg)
reg = reg %>%
mutate(success = ifelse(epa >= 1.0|first_down_rush == 1|first_down_pass == 1), 1, 0)
reg = reg %>%
mutate(success = ifelse(epa >= 1 | first_down_rush == 1 | first_down_pass == 1), 1, 0)
reg = reg %>%
mutate(success = ifelse(epa >= 1 & first_down_rush == 1 & first_down_pass == 1), 1, 0)
reg = reg %>%
mutate(success = ifelse(epa >= 1 ), 1, 0)
reg = reg %>%
mutate(success = ifelse((epa >= 1 & first_down_rush == 1 & first_down_pass == 1), 1, 0))
logreg = glm(success ~ qtr + down + ydstogo + quarter_seconds_remaining + play_type + pass_length + pass_location, data=reg, family=binomial(link="logit"))
table(reg$play_type)
nrow(!is.na(reg$pass_length))
nrow(reg[!is.na(reg$pass_length)])
nrow(reg[!is.na(reg$pass_length),])
logreg = reg %>%
select(qtr, down , ydstogo , quarter_seconds_remaining , play_type , pass_length , pass_location, success) %>%
na.omit %>%
glm(success ~ qtr + down + ydstogo + quarter_seconds_remaining + play_type + pass_length + pass_location, family=binomial(link="logit"))
logreg =
glm(success ~ qtr + down + ydstogo + quarter_seconds_remaining + play_type + pass_length + pass_location,
data = reg %>%
select(qtr, down , ydstogo , quarter_seconds_remaining , play_type , pass_length , pass_location, success) %>%
na.omit,
family=binomial(link="logit"))
test = reg %>%
select(qtr, down , ydstogo , quarter_seconds_remaining , play_type , pass_length , pass_location, success) %>%
na.omit
View(test)
table(test$success)
table(reg$success)
reg = reg %>%
mutate(success = ifelse((epa >= 1 | first_down_rush == 1 | first_down_pass == 1), 1, 0))
table(reg$success)
logreg =
glm(success ~ qtr + down + ydstogo + quarter_seconds_remaining + play_type + pass_length + pass_location,
data = reg %>%
select(qtr, down , ydstogo , quarter_seconds_remaining , play_type , pass_length , pass_location, success) %>%
na.omit,
family=binomial(link="logit"))
?predict
renderPrint(
df = data.frame("qtr" = input$quar,
"down" = input$down,
"ydstogo" = input$yds_left,
"quarter_seconds_remaining" = input$time_left*60,
"play_type" = input$play_type,
"pass_length" = input$pass_len,
"pass_location" = input$pass_loc,
"run_gap" = input$r_gap,
"run_location" = input$r_loc)
if(input$play_type == "pass") {
logreg =
glm(success ~ qtr + down + ydstogo + quarter_seconds_remaining + play_type + pass_length + pass_location,
data = reg %>%
select(qtr, down , ydstogo , quarter_seconds_remaining , play_type , pass_length , pass_location, success) %>%
na.omit,
family=binomial(link="logit"))
}
else if (input$play_type == "run") {
}
else
)
df = data.frame("qtr" = 4,
"down" = 3,
"ydstogo" = 55,
"quarter_seconds_remaining" = 300,
"play_type" = "pass",
"pass_length" = "deep",
"pass_location" = "left",
"run_gap" = NA,
"run_location" = NA)
View(df)
predicted = plogis(predict(logitMod, df))
predicted = plogis(predict(logreg, df))
df = data.frame("qtr" = 4,
"down" = 1,
"ydstogo" = 1,
"quarter_seconds_remaining" = 300,
"play_type" = "run",
"pass_length" = NA,
"pass_location" = NA,
"run_gap" = "guard",
"run_location" = "middle")
predicted = plogis(predict(logreg, df))
df = data.frame("qtr" = 4,
"down" = 1,
"ydstogo" = 1,
"quarter_seconds_remaining" = 300,
"play_type" = "pass",
"pass_length" = "short",
"pass_location" = "right",
"run_gap" = NA,
"run_location" = NA)
predicted = plogis(predict(logreg, df))
print(logreg)
print(predicted)
View(df)
View(pre)
View(reg)
post_2009 <- read_csv("data/post_season/post_pbp_2009.csv")
post_2010 <- read_csv("data/post_season/post_pbp_2010.csv")
post_2011 <- read_csv("data/post_season/post_pbp_2011.csv")
post_2012 <- read_csv("data/post_season/post_pbp_2012.csv")
post_2013 <- read_csv("data/post_season/post_pbp_2013.csv")
post_2014 <- read_csv("data/post_season/post_pbp_2014.csv")
post_2015 <- read_csv("data/post_season/post_pbp_2015.csv")
post_2016 <- read_csv("data/post_season/post_pbp_2016.csv")
post_2017 <- read_csv("data/post_season/post_pbp_2017.csv")
post_2018 <- read_csv("data/post_season/post_pbp_2018.csv")
post_2019 <- read_csv("data/post_season/post_pbp_2019.csv")
post_2019 = post_2019[, !(colnames(post_2019) %in% c("X1"))]
post_2009$Season = 2009
post_2010$Season = 2010
post_2011$Season = 2011
post_2012$Season = 2012
post_2013$Season = 2013
post_2014$Season = 2014
post_2015$Season = 2015
post_2016$Season = 2016
post_2017$Season = 2017
post_2018$Season = 2018
post_2019$Season = 2019
post_seasons = rbind(post_2009,
post_2010,
post_2011,
post_2012,
post_2013,
post_2014,
post_2015,
post_2016,
post_2017,
post_2018,
post_2019)
View(post)
View(post_seasons)
post_seasons$yrdln
post_seasons$goal_to_go
test = post_seasons %>% select(yardline_100, yrdln, desc)
View(test)
View(post_seasons)
test = post_seasons %>% select(posteam, yardline_100, yrdln, desc)
reg_2009 <- read_csv("data/regular_season/reg_pbp_2009.csv")
reg_2010 <- read_csv("data/regular_season/reg_pbp_2010.csv")
reg_2011 <- read_csv("data/regular_season/reg_pbp_2011.csv")
reg_2012 <- read_csv("data/regular_season/reg_pbp_2012.csv")
reg_2013 <- read_csv("data/regular_season/reg_pbp_2013.csv")
reg_2014 <- read_csv("data/regular_season/reg_pbp_2014.csv")
reg_2015 <- read_csv("data/regular_season/reg_pbp_2015.csv")
reg_2016 <- read_csv("data/regular_season/reg_pbp_2016.csv")
reg_2017 <- read_csv("data/regular_season/reg_pbp_2017.csv")
reg_2018 <- read_csv("data/regular_season/reg_pbp_2018.csv")
reg_2019 <- read_csv("data/regular_season/reg_pbp_2019.csv")
reg_2009$Season = 2009
reg_2010$Season = 2010
reg_2011$Season = 2011
reg_2012$Season = 2012
reg_2013$Season = 2013
reg_2014$Season = 2014
reg_2015$Season = 2015
reg_2016$Season = 2016
reg_2017$Season = 2017
reg_2018$Season = 2018
reg_2019$Season = 2019
reg_seasons = rbind(reg_2009,
reg_2010,
reg_2011,
reg_2012,
reg_2013,
reg_2014,
reg_2015,
reg_2016,
reg_2017,
reg_2018,
reg_2019)
# Need season, down, quarter_seconds_remaining, quarter, play_type, yardline_100
# epa, first_down_rush, first_down_pass
# quarter, down, yards left, time left in quarter, play type, pass length, pass location, run gap, run location
reg_seasons = reg_seasons %>%
select(Season, down, quarter_seconds_remaining, qtr, play_type, yardline_100,
epa, first_down_rush, first_down_pass, ydstogo, yardline_100,  pass_length, pass_location, run_gap, run_location)
saveRDS(reg_seasons, "reg_seasons.rds")
# Make one preseason season rds file for analysis
pre_2009 <- read_csv("data/pre_season/pre_pbp_2009.csv")
pre_2010 <- read_csv("data/pre_season/pre_pbp_2010.csv")
pre_2011 <- read_csv("data/pre_season/pre_pbp_2011.csv")
pre_2012 <- read_csv("data/pre_season/pre_pbp_2012.csv")
pre_2013 <- read_csv("data/pre_season/pre_pbp_2013.csv")
pre_2014 <- read_csv("data/pre_season/pre_pbp_2014.csv")
pre_2015 <- read_csv("data/pre_season/pre_pbp_2015.csv")
pre_2016 <- read_csv("data/pre_season/pre_pbp_2016.csv")
pre_2017 <- read_csv("data/pre_season/pre_pbp_2017.csv")
pre_2018 <- read_csv("data/pre_season/pre_pbp_2018.csv")
pre_2019 <- read_csv("data/pre_season/pre_pbp_2019.csv")
pre_2009$Season = 2009
pre_2010$Season = 2010
pre_2011$Season = 2011
pre_2012$Season = 2012
pre_2013$Season = 2013
pre_2014$Season = 2014
pre_2015$Season = 2015
pre_2016$Season = 2016
pre_2017$Season = 2017
pre_2018$Season = 2018
pre_2019$Season = 2019
pre_seasons = rbind(pre_2009,
pre_2010,
pre_2011,
pre_2012,
pre_2013,
pre_2014,
pre_2015,
pre_2016,
pre_2017,
pre_2018,
pre_2019)
pre_seasons = pre_seasons %>%
select(Season, down, quarter_seconds_remaining, qtr, play_type, yardline_100,
epa, first_down_rush, first_down_pass, ydstogo, yardline_100,  pass_length, pass_location, run_gap, run_location)
saveRDS(pre_seasons, "pre_seasons.rds")
# Make one postseason season rds file for analysis
post_2009 <- read_csv("data/post_season/post_pbp_2009.csv")
post_2010 <- read_csv("data/post_season/post_pbp_2010.csv")
post_2011 <- read_csv("data/post_season/post_pbp_2011.csv")
post_2012 <- read_csv("data/post_season/post_pbp_2012.csv")
post_2013 <- read_csv("data/post_season/post_pbp_2013.csv")
post_2014 <- read_csv("data/post_season/post_pbp_2014.csv")
post_2015 <- read_csv("data/post_season/post_pbp_2015.csv")
post_2016 <- read_csv("data/post_season/post_pbp_2016.csv")
post_2017 <- read_csv("data/post_season/post_pbp_2017.csv")
post_2018 <- read_csv("data/post_season/post_pbp_2018.csv")
post_2019 <- read_csv("data/post_season/post_pbp_2019.csv")
post_2019 = post_2019[, !(colnames(post_2019) %in% c("X1"))]
post_2009$Season = 2009
post_2010$Season = 2010
post_2011$Season = 2011
post_2012$Season = 2012
post_2013$Season = 2013
post_2014$Season = 2014
post_2015$Season = 2015
post_2016$Season = 2016
post_2017$Season = 2017
post_2018$Season = 2018
post_2019$Season = 2019
post_seasons = rbind(post_2009,
post_2010,
post_2011,
post_2012,
post_2013,
post_2014,
post_2015,
post_2016,
post_2017,
post_2018,
post_2019)
post_seasons = post_seasons %>%
select(Season, down, quarter_seconds_remaining, qtr, play_type, yardline_100,
epa, first_down_rush, first_down_pass, ydstogo, yardline_100, pass_length, pass_location, run_gap, run_location)
saveRDS(post_seasons, "post_seasons.rds")
table(pre$run_gap)
table(pre$play_type)
9403+8480+8884
9403+8480+8884-38179
table(pre$pass_location)
pre = readRDS("pre_seasons.rds")
reg = readRDS("reg_seasons.rds")
post = readRDS("post_seasons.rds")
sent = readRDS("2019_sentiments.rds")
na.omit,
ogreg =
glm(success ~ qtr + down + ydstogo + yardline_100 + quarter_seconds_remaining + play_type + run_gap + run_location,
data = reg %>%
select(qtr, down , ydstogo , yardline_100, quarter_seconds_remaining , play_type , run_gap , run_location, success) %>%
na.omit,
family=binomial(link="logit"))
reg = reg %>%
mutate(success = ifelse((epa >= 1 | first_down_rush == 1 | first_down_pass == 1), 1, 0))
logreg =
glm(success ~ qtr + down + ydstogo + yardline_100 + quarter_seconds_remaining + play_type + run_gap + run_location,
data = reg %>%
select(qtr, down , ydstogo , yardline_100, quarter_seconds_remaining , play_type , run_gap , run_location, success) %>%
na.omit,
family=binomial(link="logit"))
logreg =
glm(success ~ qtr + down + ydstogo + yardline_100 + quarter_seconds_remaining + play_type +  run_location,
data = reg %>%
select(qtr, down , ydstogo , yardline_100, quarter_seconds_remaining , play_type , run_gap , run_location, success) %>%
na.omit,
family=binomial(link="logit"))
logreg =
glm(success ~ qtr + down + ydstogo + yardline_100 + quarter_seconds_remaining + play_type,
data = reg %>%
select(qtr, down , ydstogo , yardline_100, quarter_seconds_remaining , play_type , run_gap , run_location, success) %>%
na.omit,
family=binomial(link="logit"))
logreg =
glm(success ~ qtr + down + ydstogo + yardline_100 + quarter_seconds_remaining + play_type,
data = reg %>%
select(qtr, down , ydstogo , yardline_100, quarter_seconds_remaining , play_type , success) %>%
na.omit,
family=binomial(link="logit"))
levels(reg$run_gap)
levels(reg$run_location)
factor(reg$run_location)
table(factor(reg$run_location))
level(reg$run_location)
table(reg$run_gap)
table(reg$run_location)
logreg =
glm(success ~ qtr + down + ydstogo + yardline_100 + quarter_seconds_remaining + play_type,
data = reg %>%
select(qtr, down , ydstogo , yardline_100, quarter_seconds_remaining , play_type , run_gap , run_location, success) %>%
na.omit,
family=binomial(link="logit"))
logreg =
glm(success ~ qtr + down + ydstogo + yardline_100 + quarter_seconds_remaining + play_type + run_gap + run_location,
data = reg %>%
select(qtr, down , ydstogo , yardline_100, quarter_seconds_remaining , play_type , success) %>%
na.omit,
family=binomial(link="logit"))
logreg =
glm(success ~ qtr + down + ydstogo + yardline_100 + quarter_seconds_remaining + play_type + run_gap + run_location,
data = reg %>%
select(qtr, down , ydstogo , yardline_100, quarter_seconds_remaining , play_type , run_gap ,success) %>%
na.omit,
family=binomial(link="logit"))
logreg =
glm(success ~ qtr + down + ydstogo + yardline_100 + quarter_seconds_remaining + play_type + run_gap,
data = reg %>%
select(qtr, down , ydstogo , yardline_100, quarter_seconds_remaining , play_type , run_gap ,success) %>%
na.omit,
family=binomial(link="logit"))
logreg =
glm(success ~ qtr + down + ydstogo + yardline_100 + quarter_seconds_remaining + play_type + run_location,
data = reg %>%
select(qtr, down , ydstogo , yardline_100, quarter_seconds_remaining , play_type , run_location ,success) %>%
na.omit,
family=binomial(link="logit"))
test = reg
levels(test$pass_length)
levels(test$pass_location)
factor(test$pass_length)
factor(test$pass_location)
factor(reg$run_gap)
factor(reg$run_location)
table(is.na(test$run_gap))
table(is.na(test$run_location))
test = test %>%
select(qtr, down , ydstogo , yardline_100, quarter_seconds_remaining , play_type , pass_length , pass_location, success) %>%
na.omit
table(is.na(test$run_location))
test = reg
test = test %>%
select(qtr, down , ydstogo , yardline_100, quarter_seconds_remaining , play_type , run_gap , run_location, success) %>%
na.omit
table(is.na(test$run_location))
table(is.na(test$run_gap))
glm(success ~ qtr + down + ydstogo + yardline_100 + quarter_seconds_remaining + play_type + run_gap + run_location, data = test, family=binomial(link="logit"))
glm(success ~ qtr + down + ydstogo + yardline_100 + quarter_seconds_remaining + play_type, data = test, family=binomial(link="logit"))
glm(success ~ qtr + down + ydstogo + yardline_100 + quarter_seconds_remaining +  run_gap + run_location, data = test, family=binomial(link="logit"))
